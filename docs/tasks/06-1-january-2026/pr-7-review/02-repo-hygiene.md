# PR #7 — Repo hygiene: артефакты, “пустые” файлы и проверка целостности диффа
#
# Edit description: Add checklist for cleaning stray artifacts and verifying non-empty files

Цель этого чеклиста — убрать риск “случайного мусора” в PR и обеспечить проверяемость изменений.
Фокус на двух классах проблем, замеченных в ревью PR #7 (`lllypuk/flowra`):
1) в репозитории появился непонятный объект (например, файл `api` в корне), который может быть артефактом;
2) часть файлов в PR может быть “непроверяемой” (в диффе не видно содержимое / файлы могли быть добавлены пустыми).

> Важно: без оценок времени. Это практический список шагов и критериев готовности.

---

## 1) Поиск и удаление артефактов / “случайных” файлов

### Что считать артефактами
- бинарники (`api`, `server`, `main`, `*.exe`, `*.out`, `*.bin`, `*.a`, `*.so`, `*.dylib`)
- результаты сборки (`dist/`, `build/`, `bin/` если он генерируется)
- временные файлы (`tmp/`, `.tmp/`)
- логи (`*.log`)
- IDE/OS мусор (`.DS_Store`, `.idea/`, `.vscode/` если не требуется проектом)
- coverage (`coverage.out`, `coverage.html`), профили (`*.prof`), отчёты линтера
- node/python артефакты (`node_modules/`, `__pycache__/`, `.pytest_cache/`)
- vendor-папки, если проект не фиксирует vendor осознанно

### Чеклист
- [ ] Найти в PR все новые файлы/директории, которые не являются исходным кодом/документацией/конфигом.
- [ ] Если обнаружен файл вроде `api` в корне репозитория:
  - [ ] определить, что это (бинарник/скрипт/директория/placeholder)
  - [ ] если бинарник/артефакт — удалить из PR
  - [ ] если это что-то осмысленное — переименовать в ясный путь (`cmd/...`, `scripts/...`, `docs/...`)
  - [ ] при необходимости добавить описание в README или dev guide
- [ ] Добавить/обновить `.gitignore` так, чтобы подобные файлы не попадали в git снова.

### Acceptance criteria
- [ ] В PR нет бинарников и результатов сборки.
- [ ] Любой новый файл/директория имеет понятную роль и место в структуре проекта.
- [ ] `.gitignore` предотвращает повторное добавление типичных артефактов.

---

## 2) Проверка “пустых” файлов и неполного диффа

### Почему это критично
Если файл добавлен/изменён, но его содержимое невозможно проверить (или он реально пуст), это:
- блокирует полноценное ревью;
- повышает риск, что README/доки обещают то, чего нет в коде;
- ломает доверие к тестам/покрытию и “готовности”.

### Типовые причины
- файл реально пустой (создан “на потом”)
- файл добавлен как placeholder (но без явного `.gitkeep`/пояснения)
- PR слишком большой, и платформа не показывает patch для некоторых файлов
- нестандартные атрибуты (например, LFS), хотя для `.go` это обычно не нужно

### Чеклист
- [ ] Для каждого `.go` файла со статусом “added” или “modified”:
  - [ ] подтвердить, что файл **не пустой** и содержит ожидаемую реализацию
  - [ ] если файл placeholder — заменить на `.gitkeep` с объяснением, или удалить placeholder
- [ ] Особое внимание уделить подсистемам, которые заявлены как “готовые”:
  - [ ] `internal/infrastructure/eventbus/*`
  - [ ] `internal/infrastructure/httpserver/*`
  - [ ] `internal/middleware/*`
  - [ ] `internal/infrastructure/websocket/*` и `internal/handler/websocket/*`
  - [ ] `tests/e2e/*`
- [ ] Если платформа PR не показывает diff для важных файлов:
  - [ ] проверить содержимое по исходникам в ветке PR
  - [ ] при необходимости сделать технический “rebase/commit touch” так, чтобы diff отображался
  - [ ] убедиться, что нет атрибутов, скрывающих изменения (например, LFS/атрибуты)

### Acceptance criteria
- [ ] Для ключевых компонентов из PR description/README существует реальный код, доступный для ревью.
- [ ] В PR нет пустых `.go` файлов без явной причины.
- [ ] “Скелетные” файлы не маскируются под готовую реализацию.

---

## 3) Верификация согласованности заявлений в документации с кодом

### Проблема
README/доки в PR #7 содержат сильные утверждения (“RC”, “E2E покрывают критические flows”, “entry points implemented”) — их нужно подтверждать.

### Чеклист
- [ ] Для каждого крупного утверждения в README/CLAUDE.md:
  - [ ] есть соответствующий код в репозитории
  - [ ] есть тесты/команды, которые это подтверждают
- [ ] Если в README указаны команды:
  - [ ] убедиться, что они реально работают (или явно помечены как planned)
- [ ] Если README говорит “E2E tests есть”:
  - [ ] тесты реально содержат код, имеют build tags и запускаются целевым `make`/`go test` таргетом
- [ ] Если OpenAPI/Postman добавлены:
  - [ ] убедиться, что эндпоинты реально зарегистрированы и не возвращают `501 Not Implemented` из placeholder-логики
  - [ ] убедиться, что пути и префиксы (`/api/v1`) совпадают с реализацией

### Acceptance criteria
- [ ] Документация не вводит в заблуждение и соответствует фактическому состоянию кода.
- [ ] Команды из README/DEVELOPMENT.md воспроизводимы.
- [ ] Если что-то “планируется” — это явно обозначено.

---

## 4) Рекомендация по структуре коммитов для упрощения ревью

Даже если PR уже открыт, можно улучшить ситуацию:
- [ ] Вынести чистку артефактов в отдельный commit (или отдельный PR).
- [ ] Вынести чисто документальные изменения в отдельный commit (или PR), чтобы кодовая часть ревьюилась независимо.
- [ ] Вынести “механические” изменения (например, массовые обновления README) отдельно от изменений бизнес-логики.

Acceptance criteria:
- [ ] История коммитов помогает ревью, а не мешает ему.
- [ ] Любой rollback понятен и локален.

---

## Итог: Definition of Done для hygiene части
- [ ] Неожиданные файлы (типа `api`) удалены или осмысленно переименованы/задокументированы.
- [ ] Отсутствуют бинарники и build-артефакты в git.
- [ ] Все ключевые файлы PR доступны для ревью и не являются пустыми placeholders.
- [ ] Документация соответствует коду, команды воспроизводимы.
- [ ] `.gitignore` защищает от повторного попадания артефактов.
